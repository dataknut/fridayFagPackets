---
params:
  subtitle: ""
  title: ""
  authors: ""
title: '`r params$title`'
subtitle: '`r params$subtitle`'
author: '`r params$authors`'
date: 'Last run at: `r Sys.time()`'
output:
  bookdown::html_document2:
    self_contained: true
    fig_caption: yes
    code_folding: hide
    number_sections: yes
    toc: yes
    toc_depth: 2
    toc_float: TRUE
  bookdown::pdf_document2:
    fig_caption: yes
    number_sections: yes
  bookdown::word_document2:
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_depth: 2
    fig_width: 5
bibliography: '`r path.expand("~/github/dataknut/refs/refs.bib")`'
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(data.table)
library(ggplot2)
library(kableExtra)
library(readxl)
```

# Preamble

There's a lot of talk about Carbon Taxes right now and some early signs that the UK Government will apply them to (larger) businesses post-Brexit (i.e. post-ETS). There is currently not much noise on the idea of applying them to households but it is always a possibility given the acceptance of using tax-based incentives to attempt to suppress the consumption of bad stuff. Think tobacco, alcohol and sugar.

But what if we did? How much would it raise and from whom?

There is no simple answer to this hypothetical question since it depends what [Scope of emissions](https://compareyourfootprint.com/difference-scope-1-2-3-emissions/) we consider and in what detail. Bradky speaking the scopes are:

 * Scope 1 – All direct emissions caused by burning something (gas, oil, wood, coal etc);
 * Scope 2 - Indirect emissions from electricity purchased and used - the carbon intensity of these (kg Co2/kWh) depends on how it is generated and also, of course, on which tariff you have. A 100% renewable electrons tariff will have a carbon intensity of ~0. If you have a 'normal' tariff you will just have to take what the [grid offers](https://www.carbonintensity.org.uk/);
 * Scope 3 - All Other Indirect Emissions from things you do - e.g. the things you buy (food, clothes, gadgets etc etc)

Estimating the emissions from [Scope 3](https://www.carbontrust.com/resources/briefing-what-are-scope-3-emissions) is [notably difficult](https://www.sciencedirect.com/science/article/pii/S0921800913000980) so for now we're going to make a #backOfaFagPacket estimate of the residential emissions from Scopes 1 and 2 in Southampton and see what a Carbon Tax applied to these emissions would look like.

# How?

In an ideal world we would know the fuel (gas, oil, coal, wood, electricity) inputs per year for each dwelling/household in Southampton together with details of how these are used (some methods release more carbon dioxide than others). But we don't. Once the [Smart Energy Research Laboratory](https://serl.ac.uk) really gets going we will have kWh gas and electricity data for a representative sample of British homes (but not a larger enough sample from Southampton to be helpful here). But not yet and even then it may not include other fuels... Other research has used [UK data on family expenditures on Scope 1-3 'consumption'](https://www.sciencedirect.com/science/article/pii/S0921800913000980) but we can't apply that directly to Southampton.

So what to do? There are a number of possible approaches and we're going to compare two of them:

 * Use the most recent [BEIS sub-national electricity and gas demand data](https://www.gov.uk/government/publications/regional-energy-data-guidance-note) for ~30 local areas (MSOAs) in Southampton and estimate the CO2 emissions at MSOA and (by summing them) at City level;
 * Use the modelled CO2 emissions per dwelling data in the [Energy Performance Certificate data](https://epc.opendatacommunities.org/docs/guidance) for Southampton to do the same thing.
 
Unfortunately there are problems with both which we have reported in [excessive detail elsewhere](epcChecks.html). In summary:

 * the most recent BEIS data is from 2018. This will not include dwellings and households that did not exist (new builds) at that time, nor account for any building stock improvements since then;
 * the EPC records are incomplete since an EPC is only created when a dwelling is rented or sold (since 2007);
 * the EPC data have some oddities that mean we have to [filter out a few 'impossible' values](epcChecks.html#36_Data_summary).

This means that both datasets are imperfect for the job. But they're about as close as we can currently get.

So with the usual #backOfaFagPacket health warning, let's try.

# Current estimated annual CO2 emmisions

In this #fridayFagPacket we're going to use these datasets to estimate the annual CO2 emissions at MSOA level for Southampton using
   * BEIS observed data
   * aggregated EPC data

Obviously the EPC-derived totals will not be the total CO2 emissions for **all** Southampton properties since we know not all dwellings are represented in the EPC data (see above and [in more detail](epcChecks.html#31_Check_‘missing’_EPC_rates)).

Note that we can also use the EPC estimated CO2 emissions data to look at dwelling level patterns if a Carbon Tax was applied. We leave that for a future #fridayFagPacket.

## Method

To calculate the MSOA level estimates from the BEIS data we need to apply conversion factors that convert the kWh numbers we have to CO2 emissions. We use the following:

```{r, setCarbonFactors, echo = TRUE}
elecCF <- 200 # CO2e/kWh https://www.icax.co.uk/Grid_Carbon_Factors.html
gasCF <- 215 # https://www.icax.co.uk/Carbon_Emissions_Calculator.html
```

pply 2019 mean grid carbon intensity for:
  * electricity: `r elecCF` g 
  * gas: `r gasCF` g CO2e/kWh 

For the EPC use just use the estimated CO2 values - although we should note that these are based on 'old' electricity grid carbon intensity values (ref) and since the EPC data does not provide gas and electricity kWh data seperately we cannot correct it.

```{r, co2BEIS}
sotonMSOA_DT[, sumBEIS_tCO2 := (beisElecMWh/1000)*elecCF + (beisGasMWh/1000)*gasCF]
```

```{r, co2MSOAPlot, fig.cap="Energy demand comparison"}
ggplot2::ggplot(sotonMSOA_DT, aes(x = sumBEIS_tCO2, 
                       y = sumEPC_tCO2,
                       colour = round(ownerOcc_pc))) +
  geom_abline(alpha = 0.2, slope=1, intercept=0) +
  geom_point() +
  scale_color_continuous(name = "% owner occupiers \n(Census 2011)", high = "red", low = "green") +
  #theme(legend.position = "bottom") +
  labs(x = "EPC 2020 derived total T CO2/year",
       y = "BEIS 2018 derived total T CO2/year",
       caption = "x = y line included for clarity")

#outlier <- t[sumEpcMWh > 70000]
```

\@ref(fig:energyMSOAPlot) shows that 

# Carbon Tax Scenarios

## No change to carbon intensity

* no emissions allowances (unlike the ETS and also [current UK government proposals](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/828824/Carbon_Emissions_Tax_-_Technical_Note__1_.pdf))
* [Carbon tax rate of £16/T](https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/828824/Carbon_Emissions_Tax_-_Technical_Note__1_.pdf) (currently only proposed for [businesses](https://www.gov.uk/government/publications/changes-to-tax-provisions-for-carbon-emissions-tax/changes-to-tax-provisions-for-carbon-emissions-tax))

Applying these rates enables us to calculate the Southampton and MSOA level Carbon Tax liability of households via the EPC and BEIS observed energy consumption methods.

```{r, msoaScenario1}
sotonMSOA_DT[, ct_BEIS := sumBEIS_tCO2 * 16]
sotonMSOA_DT[, ct_EPCs := sumEPC_tCO2 * 16]

t <- sotonMSOA_DT[, .(CarbonTaxBEIS_GBP = prettyNum(sum(ct_BEIS), big.mark = ","),
                      CarbonTaxEPCs_GBP = prettyNum(sum(ct_EPCs), big.mark = ",")),
                  keyby = .(LAName)]

kableExtra::kable(t, caption = "Estimated Carbon tax liability for Southampton households/properties under Scenario 1") %>%
  kable_styling()
```

As we would expect the values are relatively close due to the similar total emissions values estimated above.

If we look at the values by MSOA (\@ref(fig:carbonTaxMSOAPlot)), we find that values differ quite substantially between the methods depending on the levels of EPC records (or missing households - see above) that we are likely to have.

```{r, carbonTaxMSOAPlot, fig.cap="Energy demand comparison"}
ggplot2::ggplot(sotonMSOA_DT, aes(x = ct_BEIS/1000, 
                       y = ct_EPCs/1000,
                       colour = round(ownerOcc_pc))) +
  geom_abline(alpha = 0.2, slope=1, intercept=0) +
  geom_point() +
  scale_color_continuous(name = "% owner occupiers \n(Census 2011)", high = "red", low = "green") +
  #theme(legend.position = "bottom") +
  labs(x = "EPC 2020 derived total Carbon Tax £k/year",
       y = "BEIS 2018 derived total Carbon Tax £k/year",
       caption = "x = y line included for clarity")

#outlier <- t[sumEpcMWh > 70000]
```

Perhaps of more interest however is the relationship between estimated Carbon Tax £ and levels of deprivation. Figure \@ref(fig:carbonTaxMSOAPlotDep) shows the estimated total Carbon Tax (in £k per year) per MSOA against the proportion of households in the MSOA who do not suffer from any dimension of deprivation as defined by the English [Indices of Multiple Deprivation](https://www.nomisweb.co.uk/census/2011/qs119ew). As we can see the higher the proportion of households with no deprivation, the higher the total MSOA Carbon Tax. This suggests that a Carbon Tax will be regressive - those who pay the most are likely to be those who use more energy and thus are likely to be those who can afford to do so.

But we need to be very careful. Some deprived households might well spend a high proportion of their income on energy in order to heat very energy efficient homes. For them, a Carbon Tax would be similar to VAT - an additional burden that might be relatively small in £ terms (compared to a well-off high energy-using household) but high in terms of the % of their income (or expenditure). This is a well known issue highlighted by recent [ONS data on family energy expenditures](https://twitter.com/dataknut/status/1312855327491133441/photo/1).

```{r, carbonTaxMSOAPlotDep, fig.cap="Energy demand comparison"}

t1 <- sotonMSOA_DT[, .(MSOACode, ctSum = ct_EPCs, dep0_pc)]
t1[, source := "BEIS 2018"]
t2 <- sotonMSOA_DT[, .(MSOACode, ctSum = ct_BEIS, dep0_pc)]
t2[, source := "EPC 2020"]

plotDT <- rbind(t1,t2)

ggplot2::ggplot(plotDT, aes(x = dep0_pc, y = ctSum, colour = source)) +
  geom_point() +
  geom_smooth() +
  #theme(legend.position = "bottom") +
  labs(x = "% with no deprivation dimensions \n(Census 2011)",
       y = "Carbon Tax £k/year",
       caption = "x = y line included for clarity")

#outlier <- t[sumEpcMWh > 70000]
```


## National Grid’s Future Energy Scenarios:

 * 2030 emissions level for electricity of 0.102 kgCO2/kWh
 * gas unchanged
 
 
# R packages used

 * rmarkdown [@rmarkdown]
 * bookdown [@bookdown]
 * knitr [@knitr]
 * data.table [@data.table]
 * ggplot2 [@ggplot2]
 * kableExtra [@kableExtra]
 * readxl [@readxl]
 
# References
